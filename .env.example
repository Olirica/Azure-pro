# Express
PORT=8090
HOST=0.0.0.0
LOG_LEVEL=info
NODE_ENV=production

# Azure Speech Service
SPEECH_KEY=your-azure-speech-key
SPEECH_REGION=eastus

# Azure Translator
TRANSLATOR_KEY=your-azure-translator-key
TRANSLATOR_REGION=eastus
TRANSLATOR_ENDPOINT=https://api.cognitive.microsofttranslator.com
TRANSLATOR_PROFANITY_ACTION=NoAction

# Optional: default voice used by the TTS queue
DEFAULT_TTS_VOICE=en-US-JennyNeural
DEFAULT_TTS_VOICE_FALLBACK=en-US-GuyNeural
DEFAULT_TTS_VOICE_FR_CA=fr-CA-SylvieNeural

# Optional: Postgres for room registry (preferred for prod)
# Use Railway reference in your Node service: DATABASE_URL=${{Postgres.DATABASE_URL}}
DATABASE_URL=

# Admin access (required in production)
ADMIN_TOKEN=

# ============================================================================
# Tuning Profile: Production-tested settings
# ============================================================================

# Azure Recognition Mode (dictation | conversation | interactive)
# Note: Only used if client fetches /api/config. Speaker.tsx currently ignores this (uses dictation hardcoded)
RECOGNITION_MODE=dictation

# Speech Recognition Settings
SPEECH_STABLE_PARTIALS=3
SPEECH_SEGMENTATION_SILENCE_MS=300
SPEECH_INITIAL_SILENCE_MS=3000
SPEECH_END_SILENCE_MS=200
SPEECH_TOKEN_REFRESH_MS=540000
SPEECH_TTS_FORMAT=Audio24Khz48KBitRateMonoMp3

# Language Detection Settings
AUTO_DETECT_LANGS=en-CA,fr-CA
SPEECH_LANG_STABILITY_SEC=15
SPEECH_LANG_SWITCH_THRESHOLD=2
SPEECH_MIN_AUDIO_SEC=2

# Fast-Finals Settings (client-side STT optimization)
FASTFINALS_STABLE_K=2
FASTFINALS_MIN_STABLE_MS=350
FASTFINALS_MIN_CHARS=45
FASTFINALS_MIN_WORDS=6
FASTFINALS_EMIT_THROTTLE_MS=800
FASTFINALS_PUNCT_STABLE_MS=300
FASTFINALS_TAIL_GUARD_CHARS=10
FASTFINALS_TAIL_GUARD_WORDS=2

# Soft Patch Settings
SOFT_THROTTLE_MS=700
SOFT_MIN_DELTA_CHARS=12
FINAL_DEBOUNCE_MS=50
MAX_UTTERANCE_DURATION_MS=7000

# Patch Management
PATCH_LRU_PER_ROOM=500
PATCH_HISTORY_MAX_MS=0
CONTINUATION_MERGE_ENABLED=false

# TTS Smooth Speed Curve
TTS_BASE_SPEED=1.05
TTS_BACKLOG_RAMP_START_SEC=5
TTS_BACKLOG_RAMP_END_SEC=20
TTS_MAX_SPEED=1.30
TTS_MAX_SPEED_CHANGE_PERCENT=15
TTS_BACKLOG_FALLBACK_VOICE=

# OpenAI Translation
OPENAI_API_KEY=
OPENAI_TRANSLATE_MODEL=gpt-4o-mini
OPENAI_TRANSLATE_ENDPOINT=https://api.openai.com/v1/chat/completions

# ElevenLabs (optional)
ELEVENLABS_API_KEY=
ELEVENLABS_VOICE_FR_CA=NsFK0aDGLbVusA7tQfOB
ELEVENLABS_MODEL_ID=eleven_multilingual_v2
ELEVENLABS_TTS_ENDPOINT=https://api.elevenlabs.io/v1/text-to-speech
ELEVENLABS_STABILITY=
ELEVENLABS_SIMILARITY=

# Hybrid Translation Buffering
TRANSLATION_MERGE_ENABLED=true
TRANSLATION_MERGE_WINDOW_MS=1500
TRANSLATION_MIN_MERGE_CHARS=50
TRANSLATION_MAX_MERGE_COUNT=3

# Filler Word Filtering
FILTER_FILLER_WORDS=true

# Watchdog thresholds
WATCHDOG_EVENT_IDLE_MS=15000
WATCHDOG_PCM_IDLE_MS=7000
WS_PING_INTERVAL_MS=30000
