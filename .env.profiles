# ============================================================================
# TUNING PROFILES - Copy the profile you want to .env
# ============================================================================
# Two profiles aligned with Azure Speech recognition modes:
# - DICTATION: Best quality, no fast-finals (formal presentations, CEO speeches)
# - CONVERSATION: Fast delivery with fast-finals (meetings, webinars, Q&A) ⭐
#
# NOTE: These profiles only show timing and recognition mode settings.
# You also need these common variables in your .env (see .env.example):
# - AUTO_DETECT_LANGS (e.g., en-CA,fr-CA)
# - PHRASE_HINTS (optional domain-specific terms)
# - FILTER_FILLER_WORDS (true/false)
# - TTS settings, translator settings, etc.
# ============================================================================

# ============================================================================
# PROFILE: DICTATION (Best Quality, Professional Presentations)
# ============================================================================
# Azure Mode: dictation (enableDictation)
# Use case: CEO presentations, board meetings, formal speeches, subtitles
# Trade-offs: Higher latency (~4-5s), but excellent punctuation & accuracy
# Total latency: ~4-5 seconds
# ============================================================================

# Azure Recognition Mode
RECOGNITION_MODE=dictation              # Enables dictation mode (best punctuation)

# Azure Speech SDK Timing
SPEECH_END_SILENCE_MS=800               # Wait for complete thoughts
SPEECH_SEGMENTATION_SILENCE_MS=1200     # Long pauses for proper clause boundaries
SPEECH_INITIAL_SILENCE_MS=5000          # Allow slow presentation starts
SPEECH_STABLE_PARTIALS=4                # Maximum stability

# Fast-Finals: DISABLED for dictation mode (punctuation needs time to stabilize)
FASTFINALS_STABLE_K=99                  # Effectively disabled
FASTFINALS_MIN_STABLE_MS=9999           # Effectively disabled
FASTFINALS_PUNCT_STABLE_MS=9999         # Effectively disabled
FASTFINALS_MIN_CHARS=999                # Effectively disabled
FASTFINALS_MIN_WORDS=99                 # Effectively disabled
FASTFINALS_EMIT_THROTTLE_MS=9999        # Effectively disabled
FASTFINALS_TAIL_GUARD_CHARS=0           # Not applicable (fast-finals disabled)
FASTFINALS_TAIL_GUARD_WORDS=0           # Not applicable (fast-finals disabled)

# Soft Caption Updates (preview text)
SOFT_THROTTLE_MS=1200                   # Slower soft updates for quality
SOFT_MIN_DELTA_CHARS=25                 # Require more text growth
FINAL_DEBOUNCE_MS=200                   # Longer debounce for cleanup

# Translation Buffering
TRANSLATION_MERGE_ENABLED=false         # Disabled (SDK finals provide complete segments)
TRANSLATION_MERGE_WINDOW_MS=2000        # Not applicable (merge disabled)
TRANSLATION_MIN_MERGE_CHARS=60          # Not applicable (merge disabled)
TRANSLATION_MAX_MERGE_COUNT=4           # Not applicable (merge disabled)

# ============================================================================
# PROFILE: CONVERSATION (Aggressive SDK Finals) ⭐ RECOMMENDED
# ============================================================================
# Azure Mode: conversation (default Azure mode)
# Use case: Team meetings, webinars, fast speakers, Q&A sessions
# Strategy: Aggressive silence thresholds make SDK finals fire on natural pauses
#           NO fast-finals (they commit unstable garbage text)
# Trade-offs: Fast delivery, good quality (SDK finals are stable)
# Total latency: ~1.5-2.5 seconds (fires every 200-300ms pause)
# ============================================================================

# Azure Recognition Mode
RECOGNITION_MODE=conversation           # Standard conversation mode

# Azure Speech SDK Timing (AGGRESSIVE - fire on short pauses)
SPEECH_END_SILENCE_MS=200               # Fire SDK final after 200ms pause (natural breath)
SPEECH_SEGMENTATION_SILENCE_MS=300      # Segment on 300ms pause (keeps up with fast speakers)
SPEECH_INITIAL_SILENCE_MS=3000          # Standard silence timeout
SPEECH_STABLE_PARTIALS=3                # Moderate stability (balance speed and quality)

# Fast-Finals: DISABLED (unstable text causes "vacuum cleaner" hallucinations)
FASTFINALS_STABLE_K=99                  # Effectively disabled
FASTFINALS_MIN_STABLE_MS=9999           # Effectively disabled
FASTFINALS_PUNCT_STABLE_MS=9999         # Effectively disabled
FASTFINALS_MIN_CHARS=999                # Effectively disabled
FASTFINALS_MIN_WORDS=99                 # Effectively disabled
FASTFINALS_EMIT_THROTTLE_MS=9999        # Effectively disabled
FASTFINALS_TAIL_GUARD_CHARS=0           # Not applicable (fast-finals disabled)
FASTFINALS_TAIL_GUARD_WORDS=0           # Not applicable (fast-finals disabled)

# Soft Caption Updates (preview text)
SOFT_THROTTLE_MS=700                    # Fast soft updates
SOFT_MIN_DELTA_CHARS=12                 # Low text growth requirement
FINAL_DEBOUNCE_MS=50                    # Quick batching (duration timeout handles long speech)

# Translation Buffering
TRANSLATION_MERGE_ENABLED=false         # Disabled (independent segment translation)
TRANSLATION_MERGE_WINDOW_MS=1200        # Not applicable (merge disabled)
TRANSLATION_MIN_MERGE_CHARS=40          # Not applicable (merge disabled)
TRANSLATION_MAX_MERGE_COUNT=2           # Not applicable (merge disabled)

# ============================================================================
# HOW TO USE THESE PROFILES
# ============================================================================
# 1. Start with .env.example or your existing .env file
# 2. Choose the profile that matches your use case above
# 3. Copy ALL the variables from that profile section
# 4. Paste/replace them into your .env file (or Railway dashboard)
# 5. Ensure you also have these profile-independent settings:
#    - AUTO_DETECT_LANGS=en-CA,fr-CA (or your languages)
#    - PHRASE_HINTS=YourBrand,Terms,Here (optional)
#    - FILTER_FILLER_WORDS=true (recommended)
#    - Azure credentials (SPEECH_KEY, TRANSLATOR_KEY, etc.)
#    - TTS settings (see .env.example for details)
# 6. Restart your server
#
# RECOGNITION_MODE is the key difference:
# - dictation = Best punctuation, capitalization, homophone resolution (no fast-finals)
# - conversation = Natural dialogue, fast-finals enabled for speed
#
# Emission Strategy:
# - DICTATION: Waits for long silence (~800-1200ms) for best punctuation
# - CONVERSATION: Fires on short pauses (~200-300ms) to keep up with fast speakers
#                 Fast-finals DISABLED (unstable text causes quality issues)
#
# Language ID Priority is set client-side:
# - When AUTO_DETECT_LANGS is configured and user selects "auto" language,
#   the client automatically uses "Accuracy" priority for best language detection
# ============================================================================

# ============================================================================
# COMPARISON TABLE
# ============================================================================
# Profile      | Mode         | Strategy              | Latency   | Quality     | Punctuation | Use Case
# -------------|--------------|------------------------|-----------|-------------|-------------|------------------
# CONVERSATION | conversation | Aggressive SDK finals  | ~1.5-2.5s | ⭐⭐⭐⭐    | Good        | Meetings, fast speakers ⭐
# DICTATION    | dictation    | Wait for long silence  | ~4-5s     | ⭐⭐⭐⭐⭐   | Excellent   | CEO speeches, formal
# ============================================================================
#
# Key Insight: Fast-finals (client-side) commit unstable garbage text. Instead, use aggressive
# silence thresholds to make SDK finals fire faster on natural speech pauses (200-300ms).
